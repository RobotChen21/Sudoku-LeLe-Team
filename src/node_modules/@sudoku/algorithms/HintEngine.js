import { NakedSingleStrategy } from './strategies/NakedSingleStrategy';
import { HiddenSingleStrategy } from './strategies/HiddenSingleStrategy';
import { solveSudoku } from '../sudoku';

const strategies = [
	new NakedSingleStrategy(),
	new HiddenSingleStrategy(),
];

export function getHint(grid) {
	for (const strategy of strategies) {
		const hint = strategy.findHint(grid);
		if (hint) return hint;
	}

	const solved = solveSudoku(grid);
	if (!solved) return null;

	for (let y = 0; y < 9; y++) {
		for (let x = 0; x < 9; x++) {
			if (grid[y][x] === 0 && solved[y][x] !== 0) {
				return {
					hintType: '完整求解器（兜底）',
					targetCell: [x, y],
					value: solved[y][x],
					relatedCells: [],
					reason: '当前盘面需要高级策略，系统将提供一个可行解。',
				};
			}
		}
	}

	return null;
}
