// src/node_modules/@sudoku/algorithms/utils/candidates.ts

import type { Grid } from '../types';

/**
 * 获取某个空格的所有候选数字（1~9 中未被行列宫排除的数字）
 */
export function getCandidates(grid: Grid, x: number, y: number): number[] {
  if (grid[y][x] !== 0) return [];

  const used = new Set<number>();

  // 检查行
  for (let col = 0; col < 9; col++) {
    if (grid[y][col] !== 0) used.add(grid[y][col]);
  }

  // 检查列
  for (let row = 0; row < 9; row++) {
    if (grid[row][x] !== 0) used.add(grid[row][x]);
  }

  // 检查宫
  const boxX = Math.floor(x / 3) * 3;
  const boxY = Math.floor(y / 3) * 3;
  for (let dy = 0; dy < 3; dy++) {
    for (let dx = 0; dx < 3; dx++) {
      const val = grid[boxY + dy][boxX + dx];
      if (val !== 0) used.add(val);
    }
  }

  const candidates: number[] = [];
  for (let n = 1; n <= 9; n++) {
    if (!used.has(n)) candidates.push(n);
  }
  return candidates;
}